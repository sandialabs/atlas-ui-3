# CodeQL data extension to model sanitizers in this repo
# Registers sanitize_for_logging as a sanitizer so taint is removed when data flows through it.
# Reference: CodeQL model packs (Python)

extensions:
  - addsTo:
      pack: codeql/python-all
      extensible: sanitizer
    data:
      # Format: [module, function, output, taintKinds]
      # Mark the function's return value as sanitized for all taint kinds.
      - ["core.utils", "sanitize_for_logging", "ReturnValue", "All"]
      # Also include fully-qualified path with atlas prefix in case imports resolve that way in analysis
      - ["atlas.core.utils", "sanitize_for_logging", "ReturnValue", "All"]
